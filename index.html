<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="index.css">

    <script>
        (function() {
            // Store private reference to Jitsu instance
            let privateJitsuInstance = null;

            // Private scope for Jitsu configuration
            const jitsuConfig = {
                initOnly: true
            };

            // Create a closure to handle Jitsu initialization
            function initializeJitsu(jitsu) {
                privateJitsuInstance = jitsu;

                // Create analytics interface with limited exposure
                window.analytics = {
                    track: function(eventName, properties) {
                        privateJitsuInstance.track(eventName, properties);
                    },
                    identify: function(userId, traits) {
                        privateJitsuInstance.identify(userId, traits);
                    }
                };

                // Clean up all Jitsu-related objects
                setTimeout(() => {
                    delete window.jitsu;
                    delete window.jitsuQ;
                    delete window.jitsuConfig;
                    delete window.jitsuLoaded;
                }, 0);
            }

            // Temporary initialization function
            window.jitsuLoaded = function(jitsu) {
                initializeJitsu(jitsu);
            };

            // Add Jitsu script with configuration
            const script = document.createElement('script');
            script.src = 'https://cm60qnthl00002v6orm0kilny.d.jitsu.com/p.js';
            script.async = true;
            script.setAttribute('data-onload', 'jitsuLoaded');
            document.head.appendChild(script);
        })();
    </script>
</head>
<body>
    <button onclick="handleClick()">Track Me</button>

    <script>
        const handleClick = (function() {
            // Private function scope
            return function() {
                if (window.analytics) {
                    window.analytics.track('button_clicked', {
                        buttonName: 'Track Me',
                        timestamp: new Date().toISOString()
                    });
                    alert('Event tracked!');
                } else {
                    console.error('Analytics not initialized');
                    alert('Analytics not ready. Please try again.');
                }
            };
        })();
    </script>
</body>
</html>